#line 12 "c:\sci\include\rddName.ch"
    EXTERNAL leto
    EXTERNAL DBFNTX
   EXTERNAL DBFCDX


    EXTERNAL DBFFPT
    EXTERNAL SIXCDX
    EXTERNAL DBFNSX
    EXTERNAL HB_MEMIO
#line 3 "tambient.prg"
_HB_CLASS TAmbiente ; function TAmbiente ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TAmbiente", iif( .F., { }, { @HBObject() } ), @TAmbiente() ) ) ;
    nScope := 1 ; ( ( nScope ) )
        _HB_MEMBER { aLpt1 } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aLpt1"}, .F. )
        _HB_MEMBER { aLpt2 } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aLpt2"}, .F. )
        _HB_MEMBER { aLpt3 } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aLpt3"}, .F. )
        _HB_MEMBER { nMenuH } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nMenuH"}, .F. )
        _HB_MEMBER { nMenuV } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nMenuV"}, .F. )
        _HB_MEMBER { LetoIP } ; oClass:AddMultiData(, "127.0.0.1", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoIP"}, .F. )
       _HB_MEMBER { LetoPort } ; oClass:AddMultiData(, "2812", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoPort"}, .F. )
        _HB_MEMBER { LetoI } ; oClass:AddMultiData(, "//", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoI"}, .F. )
        _HB_MEMBER { LetoM } ; oClass:AddMultiData(, ":", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoM"}, .F. )
        _HB_MEMBER { LetoF } ; oClass:AddMultiData(, "/", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoF"}, .F. )
        _HB_MEMBER { LetoPath } ; oClass:AddMultiData(, "//127.0.0.1:2812/", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoPath"}, .F. )
        _HB_MEMBER { LetoAtivo } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LetoAtivo"}, .F. )
        _HB_MEMBER { ShowVarLetoString } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"ShowVarLetoString"}, .F. )
        _HB_MEMBER { ShowVarString } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"ShowVarString"}, .F. )

    nScope := 1 ; ( ( nScope ) )
        _HB_MEMBER { Ano2000 } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Ano2000"}, .F. )
        _HB_MEMBER { Frame } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Frame"}, .F. )
        _HB_MEMBER { Visual } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Visual"}, .F. )
        _HB_MEMBER { CorMenu } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorMenu"}, .F. )
        _HB_MEMBER { CorLightBar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorLightBar"}, .F. )
        _HB_MEMBER { CorHotKey } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorHotKey"}, .F. )
        _HB_MEMBER { CorHKLightBar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorHKLightBar"}, .F. )
        _HB_MEMBER { CorDesativada } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorDesativada"}, .F. )
        _HB_MEMBER { CorAntiga } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorAntiga"}, .F. )
        _HB_MEMBER { CorCabec } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorCabec"}, .F. )
        _HB_MEMBER { CorBorda } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorBorda"}, .F. )
        _HB_MEMBER { CorAlerta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorAlerta"}, .F. )
        _HB_MEMBER { CorBox } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorBox"}, .F. )
        _HB_MEMBER { CorCima } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorCima"}, .F. )
        _HB_MEMBER { CorFundo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorFundo"}, .F. )
        _HB_MEMBER { CorMsg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"CorMsg"}, .F. )
        _HB_MEMBER { HoraCerta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"HoraCerta"}, .F. )
        _HB_MEMBER { TarefaConcluida } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"TarefaConcluida"}, .F. )
        _HB_MEMBER { Clock } ; oClass:AddMultiData(, Time(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Clock"}, .F. )
        _HB_MEMBER { Fonte } ; oClass:AddMultiData(, 2, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Fonte"}, .F. )
        _HB_MEMBER { Selecionado } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Selecionado"}, .F. )
        _HB_MEMBER { Sombra } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Sombra"}, .F. )
        _HB_MEMBER { Panos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Panos"}, .F. )
        _HB_MEMBER { ModeMenu } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"ModeMenu"}, .F. )
        _HB_MEMBER { PanoFundo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"PanoFundo"}, .F. )
        _HB_MEMBER { PrintReady } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"PrintReady"}, .F. )
        _HB_MEMBER { aPermissao } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aPermissao"}, .F. )
        _HB_MEMBER { xBaseDados } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xBaseDados"}, .F. )
        _HB_MEMBER { xBaseDoc } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xBaseDoc"}, .F. )
        _HB_MEMBER { xBaseTxt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xBaseTxt"}, .F. )
        _HB_MEMBER { xBaseTMP } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xBaseTMP"}, .F. )
        _HB_MEMBER { xImpressora } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xImpressora"}, .F. )
        _HB_MEMBER { Get_Ativo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Get_Ativo"}, .F. )
        _HB_MEMBER { Acento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Acento"}, .F. )
        _HB_MEMBER { xDataCodigo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xDataCodigo"}, .F. )
        _HB_MEMBER { Spooler } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Spooler"}, .F. )
        _HB_MEMBER { Externo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Externo"}, .F. )
        _HB_MEMBER { cArquivo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cArquivo"}, .F. )
        _HB_MEMBER { TabelaFonte } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"TabelaFonte"}, .F. )
        _HB_MEMBER { Argumentos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Argumentos"}, .F. )
        _HB_MEMBER { HB_Argc } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"HB_Argc"}, .F. )
        _HB_MEMBER { HB_Argv } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"HB_Argv"}, .F. )
        _HB_MEMBER { Drive } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Drive"}, .F. )
        _HB_MEMBER { xBase } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xBase"}, .F. )
        _HB_MEMBER { xRoot } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xRoot"}, .F. )
        _HB_MEMBER { Normal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Normal"}, .F. )


        _HB_MEMBER { Mostrar_Desativados } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Mostrar_Desativados"}, .F. )
        _HB_MEMBER { Mostrar_Recibo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Mostrar_Recibo"}, .F. )
        _HB_MEMBER { PosiAgeInd } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"PosiAgeInd"}, .F. )
        _HB_MEMBER { PosiAgeAll } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"PosiAgeAll"}, .F. )
        _HB_MEMBER { RecePosi } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"RecePosi"}, .F. )
        _HB_MEMBER { lReceber } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lReceber"}, .F. )
        _HB_MEMBER { lRecepago } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lRecepago"}, .F. )
        _HB_MEMBER { cTipoRecibo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTipoRecibo"}, .F. )
        _HB_MEMBER { Color_pFore } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Color_pFore"}, .F. )
        _HB_MEMBER { Color_pBack } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Color_pBack"}, .F. )
        _HB_MEMBER { Color_pUns } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Color_pUns"}, .F. )
        _HB_MEMBER { aAtivo } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aAtivo"}, .F. )
        _HB_MEMBER { aAtivoSwap } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aAtivoSwap"}, .F. )

        _HB_MEMBER { lGreenCard } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lGreenCard"}, .F. )
        _HB_MEMBER { lComCodigoAcesso } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lComCodigoAcesso"}, .F. )
        _HB_MEMBER { aFiscalIni } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFiscalIni"}, .F. )
        _HB_MEMBER { xLimite } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xLimite"}, .F. )
        _HB_MEMBER { _Empresa } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"_Empresa"}, .F. )
        _HB_MEMBER { xFanta } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xFanta"}, .F. )
        _HB_MEMBER { xNomefir } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xNomefir"}, .F. )
        _HB_MEMBER { xEmpresa } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xEmpresa"}, .F. )
        _HB_MEMBER { xJuroMesComposto } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xJuroMesComposto"}, .F. )
        _HB_MEMBER { xJuroMesSimples } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xJuroMesSimples"}, .F. )
        _HB_MEMBER { aSciArray } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aSciArray"}, .F. )
        _HB_MEMBER { lContinuarAchoice } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lContinuarAchoice"}, .F. )
        _HB_MEMBER { Menu } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Menu"}, .F. )
        _HB_MEMBER { Disp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Disp"}, .F. )
        _HB_MEMBER { Usuario } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Usuario"}, .F. )
        _HB_MEMBER { nRegistrosImpressos } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRegistrosImpressos"}, .F. )
        _HB_MEMBER { StatusSup } ; oClass:AddMultiData(, "Macrosoft", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"StatusSup"}, .F. )
        _HB_MEMBER { StatusInf } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"StatusInf"}, .F. )
        _HB_MEMBER { xUsuario } ; oClass:AddMultiData(, "ADMIN", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xUsuario"}, .F. )
        _HB_MEMBER { NomeFirma } ; oClass:AddMultiData(, "VCATAFESTA@GMAIL.COM", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"NomeFirma"}, .F. )
        _HB_MEMBER { Codifirma } ; oClass:AddMultiData(, "0001", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Codifirma"}, .F. )
        _HB_MEMBER { xProgramador } ; oClass:AddMultiData(, "Vilmar Catafesta", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xProgramador"}, .F. )
        _HB_MEMBER { Alterando } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Alterando"}, .F. )
        _HB_MEMBER { nPos } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPos"}, .F. )
        _HB_MEMBER { Ativo } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Ativo"}, .F. )
        _HB_MEMBER { FonteManualAltura } ; oClass:AddMultiData(, MS_MaxRow(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"FonteManualAltura"}, .F. )
        _HB_MEMBER { FonteManualLargura } ; oClass:AddMultiData(, MS_MaxCol(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"FonteManualLargura"}, .F. )
        _HB_MEMBER { AlturaFonteDefaultWindows } ; oClass:AddMultiData(, MS_MaxRow(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"AlturaFonteDefaultWindows"}, .F. )
        _HB_MEMBER { LarguraFonteDefaultWindows } ; oClass:AddMultiData(, MS_MaxCol(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"LarguraFonteDefaultWindows"}, .F. )
        _HB_MEMBER { RelatorioCabec } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"RelatorioCabec"}, .F. )
        _HB_MEMBER { MaxCol } ; oClass:AddMultiData(, MaxCol()+1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"MaxCol"}, .F. )
        _HB_MEMBER { lK_Ctrl_Ins } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lK_Ctrl_Ins"}, .F. )
        _HB_MEMBER { lK_Ctrl_Del } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lK_Ctrl_Del"}, .F. )
        _HB_MEMBER { lK_Insert } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lK_Insert"}, .F. )
        _HB_MEMBER { lk_Insert_Plus } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lk_Insert_Plus"}, .F. )
        _HB_MEMBER { ZebrarAmostragem } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"ZebrarAmostragem"}, .F. )
        _HB_MEMBER { lMostrarSoma } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lMostrarSoma"}, .F. )
        _HB_MEMBER { StSupArray } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"StSupArray"}, .F. )
        _HB_MEMBER { StInfArray } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"StInfArray"}, .F. )
        _HB_MEMBER { MenuArray } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"MenuArray"}, .F. )
        _HB_MEMBER { DispArray } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"DispArray"}, .F. )
        _HB_MEMBER { hESCP } ; oClass:AddMultiData(, {=>}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hESCP"}, .F. )

    nScope := 1 ; ( ( nScope ) )
        _HB_MEMBER cor_menu(); oClass:AddMethod( "cor_menu", @TAmbiente_getcormenu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER _cor_menu(); oClass:AddMethod( "_cor_menu", @TAmbiente_setcormenu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

        _HB_MEMBER new() AS CLASS TAmbiente; oClass:AddMethod( "new", @TAmbiente_new(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Destroy(); oClass:AddMethod( "Destroy", @TAmbiente_Destroy(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER ConfAmbiente(); oClass:AddMethod( "ConfAmbiente", @TAmbiente_ConfAmbiente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Ano2000On(); oClass:AddMethod( "Ano2000On", @TAmbiente_Ano2000On(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Ano2000Of(); oClass:AddMethod( "Ano2000Of", @TAmbiente_Ano2000Of(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetVar(); oClass:AddMethod( "SetVar", @TAmbiente_SetVar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetSet(); oClass:AddMethod( "SetSet", @TAmbiente_SetSet(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetPano(); oClass:AddMethod( "SetPano", @TAmbiente_SetPano(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetModeMenu(); oClass:AddMethod( "SetModeMenu", @TAmbiente_SetModeMenu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER xDisp(); oClass:AddMethod( "xDisp", @TAmbiente_xDisp(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER xMenu(); oClass:AddMethod( "xMenu", @TAmbiente_xMenu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Show(); oClass:AddMethod( "Show", @TAmbiente_Show(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCor(); oClass:AddMethod( "SetaCor", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaFrame(); oClass:AddMethod( "SetaFrame", @TAmbiente_SetaFrame(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaSombra(); oClass:AddMethod( "SetaSombra", @TAmbiente_SetaSombra(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaPano(); oClass:AddMethod( "SetaPano", @TAmbiente_SetaPano(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER statReg(); oClass:AddMethod( "statReg", @TAmbiente_statReg(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER StatInf(); oClass:AddMethod( "StatInf", @TAmbiente_StatInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER StatSup(); oClass:AddMethod( "StatSup", @TAmbiente_StatSup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Limpa(); oClass:AddMethod( "Limpa", @TAmbiente_Limpa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER MaBox(); oClass:AddMethod( "MaBox", @TAmbiente_MaBox(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER MSMenuCabecalho(); oClass:AddMethod( "MSMenuCabecalho", @TAmbiente_MSMenuCabecalho(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER MSProcessa(); oClass:AddMethod( "MSProcessa", @TAmbiente_MSProcessa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER MSMenu(); oClass:AddMethod( "MSMenu", @TAmbiente_MSMenu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaFonte(); oClass:AddMethod( "SetaFonte", @TAmbiente_SetaFonte(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetVar(); oClass:AddMethod( "SetVar", @TAmbiente_SetVar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Refresh(); oClass:AddMethod( "Refresh", @TAmbiente_Refresh(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER Destroy(); oClass:AddMethod( "Destroy", @TAmbiente_Destroy(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER AumentaEspacoMenu(); oClass:AddMethod( "AumentaEspacoMenu", @TAmbiente_AumentaEspacoMenu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaFonteManual(); oClass:AddMethod( "SetaFonteManual", @TAmbiente_SetaFonteManual(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER PreVisFonte(); oClass:AddMethod( "PreVisFonte", @TAmbiente_PreVisFonte(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER ContaReg(); oClass:AddMethod( "ContaReg", @TAmbiente_ContaReg(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER MostraPosicaoMenuNoCabecalho(); oClass:AddMethod( "MostraPosicaoMenuNoCabecalho", @TAmbiente_MostraPosicaoMenuNoCabecalho(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER HelpCor( xColor); oClass:AddMethod( "HelpCor", @TAmbiente_HelpCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER EscapeCode(); oClass:AddMethod( "EscapeCode", @TAmbiente_EscapeCode(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER GetLetoPath(); oClass:AddMethod( "GetLetoPath", @TAmbiente_GetLetoPath(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER ShowVar( lPause, cMsgAdicional, lMostrar); oClass:AddMethod( "ShowVar", @TAmbiente_ShowVar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER ShowVarLeto( lPause, cMsgAdicional, lMostrar); oClass:AddMethod( "ShowVarLeto", @TAmbiente_ShowVarLeto(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

        _HB_MEMBER Create(); oClass:AddMethod( "Create", @TAmbiente_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCorAlerta(); oClass:AddMethod( "SetaCorAlerta", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCorMsg(); oClass:AddMethod( "SetaCorMsg", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCorLightBar(); oClass:AddMethod( "SetaCorLightBar", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCorHotKey(); oClass:AddMethod( "SetaCorHotKey", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCorHKLightBar(); oClass:AddMethod( "SetaCorHKLightBar", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
        _HB_MEMBER SetaCorBorda(); oClass:AddMethod( "SetaCorBorda", @TAmbiente_SetaCor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TAmbiente ;

static FUNCTION TAmbiente_ShowVar( lPause, cMsgAdicional, lMostrar ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    hb_default(@lPause, .F.)
    hb_default(@cMsgAdicional, "")
    hb_default(@lMostrar, .T.)









    ::ShowVarString :=     "Principais Variaveis TAMBIENTE (acrescente se precisar :-);-;" +     "::xroot     # " + formatavar(self:xroot)       + ";" +     "::xbase     # " + formatavar(self:xbase)       + ";" +     "::xusuario  # " + formatavar(self:xusuario)    + ";" +     "::_Empresa  # " + formatavar(self:_Empresa)    + ";" +     "::xEmpresa  # " + formatavar(self:xEmpresa)    + ";" +     "::xFanta    # " + formatavar(self:xFanta)    + ";" +     "::xNomefir  # " + formatavar(self:xNomefir)    + ";" +     "::Drive     # " + formatavar(self:Drive)    + cMsgAdicional
    if lMostrar
        AlertaPy(::ShowVarString, 31, .F., lPause)
    endif
    return ::ShowVarString



static FUNCTION TAmbiente_ShowVarLeto( lPause, cMsgAdicional, lMostrar ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    hb_default(@lPause, .F.)
    hb_default(@cMsgAdicional, "")
    hb_default(@lMostrar, .T.)




    ::ShowVarLetoString :=  "Variaveis do AMBIENTE Leto :-);-;" +     "::LetoIp    # " + formatavar(::LetoIP)       + ";" +     "::LetoPort  # " + formatavar(::LetoPort)       + ";" +     "::LetoPath  # " + formatavar(::LetoPath)      + ";" +     "::LetoAtivo # " + formatavar(::LetoAtivo)   + cMsgAdicional

    if lMostrar
        AlertaPy(::ShowVarLetoString, 31, .F., lPause)
    endif
    return(::ShowVarLetoString)


static FUNCTION TAmbiente_GetLetoPath( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL cHost := ""
    cHost := ::LetoI
    cHost += ::LetoIP
    cHost += ::LetoM
    cHost += ::LetoPort
    cHost += ::LetoF
    ::LetoPath := cHost
    return ::LetoPath

static FUNCTION TAmbiente_New( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    ::hESCP               := ::EscapeCode()
    ::Argumentos          := HB_Argc()
    ::HB_Argc                := HB_Argc()
    ::xRoot               := GetRoot(HB_Argv(0))
   ::Drive               := if(::argumentos  = 0 , nil , HB_Argv(1))
   ::Normal              := if(::argumentos <= 2 , nil , HB_Argv(3))
    ::Visual              := if(::argumentos <= 1 , .F. , .T. )
   ::Panos               := ::SetPano()
    ::ModeMenu                  := ::SetModeMenu()
   ::Selecionado         := 10
   ::PanoFundo           := ::Panos[10]
   ::Frame               := "⁄ƒø≥Ÿƒ¿≥"
   ::Cormenu             := 31
    ::CorDesativada       := 8
    ::CorLightBar         := 124
    ::CorHotKey           := 10
    ::CorHKLightBar       := 14
   ::Ano2000             := .F.
    ::Menu                := ::xMenu()
   ::Disp                := ::xDisp()
    ::nPos                := 1
    ::SetPano()
    ::GetLetoPath()

   if "-V" $ Upper(HB_Argv(1)) .OR. "--version" $ Upper(HB_Argv(1))
      version()
      __Quit()
    endif

    M_Frame( ::Frame )
    setColor("")
    Scroll() ; SetPos( 0, 0 )

    Qout("˛ Macrosoft Sci, Copyrigh(c), 1991-2018, Vilmar Catafesta.")
    Qout("˛ Carregando Configuracao.")
    if ::Drive = NIL
      ::Drive := FCurdir()
    else
      ::Drive := ltrim(rtrim(Upper(::Drive)))
        if Left(::Drive, 2) == "\\"
         if Len(::Drive) > 2
            if Right(::Drive, 1) == "\"
               ::Drive := Left(::Drive,Len(::Drive)-1)
            endif
         endif
      endif

      if Len(::Drive) = 3
         if SubStr(::Drive, 2,2) == ":\"
            ::Drive := Left(::Drive,Len(::Drive)-1)
            endif
        endif
    endif

    aadd(::HB_Argv, HB_Argv(1))
    aadd(::HB_Argv, HB_Argv(2))
    aadd(::HB_Argv, HB_Argv(3))

    if ::Normal = NIL .OR. ::Drive = NIL

   endif

   ::SetVar()
   ::PrintReady     := 1
   ::aPermissao    := {}
   ::xBase         := ( ::Drive )
   ::xBaseDados    := ( ::Drive )
   ::xBaseDoc      := ( ::Drive )
    ::xBaseTxt      := ( ::Drive )
    ::xBaseTMP      := ( ::Drive )
   ::xImpressora   := 1
   ::Get_Ativo     := .T.
   ::Acento        := .F.
   ::xDataCodigo   := "  /  /  "
   ::Spooler       := .F.
   ::Externo       := .F.
   ::cArquivo      := ""
   ::ConfAmbiente()
    return self


static FUNCTION TAmbiente_getcormenu( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    return ::CorMenu


static FUNCTION TAmbiente_setcormenu( cormenu ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    return iif( cormenu <> NIL, ::cormenu := cormenu, cormenu)


static FUNCTION TAmbiente_Destroy( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    self := nil
    return nil


static FUNCTION TAmbiente_Ano2000On( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
   LETO_SET( 5, 1950 )
   ::Ano2000 := .T.
    return( Self )


static FUNCTION TAmbiente_Ano2000Of( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
   LETO_SET( 5, 1900 )
   ::Ano2000 := .F.
    return( Self )


static FUNCTION TAmbiente_SetaFonteManual( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nLargura  := ::FonteManualLargura
    LOCAL nAltura   := ::FonteManualAltura

    ::Limpa()
    MaBox( 10, 10, 16, 50, "LAYOUT: Tamanho do buffer da tela" )
    SetCursor(1) ; DevPos( 12, 11 ) ; DevOut( "Altura:  " ) ; SetCursor(1) ; SetPos( Row(), Col()+1 ) ; AAdd( GetList, _GET_( nAltura, "nAltura", "999",,))
    SetCursor(1) ; DevPos( 14, 11 ) ; DevOut( "Largura: " ) ; SetCursor(1) ; SetPos( Row(), Col()+1 ) ; AAdd( GetList, _GET_( nLargura, "nLargura", "999",,))
    ReadModal( GetList, NIL,,,,, ) ; GetList := {} ; ( GetList )
    if LastKey() = 27
        return NIL
    endif
    ::FonteManualLargura := nLargura
    ::FonteManualAltura  := nAltura
    ::MaxCol             := nLargura


    return( self )


static FUNCTION TAmbiente_PreVisFonte( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nFonte
    LOCAL Selecionado  := 1
    LOCAL nKey             := 0
    LOCAL cScreen      := SaveScreen()
    LOCAL oTemp

    nFonte         := Len( ::TabelaFonte )
    nPos           := Ascan( ::TabelaFonte, ::Fonte )
    Selecionado     := if( nPos = 0, 1, nPos )
    cPanoFundo        := ::PanoFundo
    cCormenu         := ::Cormenu
    cCorCabec      := ::CorCabec
    cCorFundo        := ::CorFundo

    oTemp           := TAmbienteNew()
    oTemp:PanoFundo := cPanoFundo
    oTemp:Cormenu     := cCormenu
    oTemp:CorCabec     := cCorCabec
    oTemp:CorFundo     := cCorFundo

    while( .T. )
        __Keyboard( ( Chr( 27 )) )
        oTemp:Show()
        oTemp:contareg("#" + StrZero(Selecionado,3) + "# {" + ::ModeMenu[Selecionado] + "}")
        M_Frame( ::Frame )
        M_Message("UP/DOWN, ENTER, ESC. #" + StrZero(Selecionado,3), ::Cormenu )
        nKey := Inkey(0)
        if nKey == 27
            return Self
        elseif nKey == 13
            exit
        elseif nKey == 5
            Selecionado := Iif( Selecionado == 1, nFonte, --Selecionado  )
        elseif nKey == 24
            Selecionado := Iif( Selecionado == nFonte, 1, ++Selecionado  )
        endif
        Eval( ::TabelaFonte[ Selecionado ])
        Cls( ::CorFundo, ::PanoFundo, .T. )
    EndDo
    ::Fonte := Selecionado
    return Self


static FUNCTION TAmbiente_SetaFonte( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nLargura     := ::FonteManualLargura
    LOCAL nAltura      := ::FonteManualAltura
    LOCAL nChoice      := 1

    M_Title("SELECIONE MODO DE VIDEO")
    nChoice := FazMenu( 03, 10, ::ModeMenu)
    if nChoice = 0
        return

    elseif nChoice = 21
        ::SetaFonteManual()
    elseif nChoice = 22
        ::PreVisFonte()
        nChoice := ::Fonte

    endif
    Eval( ::TabelaFonte[ nChoice ])
    Cls( ::CorFundo, ::PanoFundo, .T. )
    if Alert("LAYOUT;" + "Tamanho do buffer da tela;;" + "Largura:     " + Str( MS_MaxCol()) + ";Altura:      " + Str( MS_MaxRow()), {"Ok","Cancelar"}) == 1
        ::Fonte := nChoice
    else
        ::FonteManualLargura  := nLargura
        ::FonteManualAltura   := nAltura
        Eval( ::TabelaFonte[ ::Fonte])
        Cls( ::CorFundo, ::PanoFundo, .T. )
    endif
    return(Self)


static FUNCTION TAmbiente_ConfAmbiente( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    if ::Argumentos = 0
        ::Frame := "…–À« Ã»∂"
    elseif ::Argumentos = 1
        ::Frame := "…–À« Ã»∂"
    elseif ::Argumentos = 2
        ::Frame := "…–À« Ã»∂"
    elseif ::Argumentos = 3
        ::Frame := "⁄ƒø≥Ÿƒ¿≥"
    endif
    ::Frame := "⁄ƒø≥Ÿƒ¿≥"

    M_Frame( ::Frame )
    ::xBase           := ( ::Drive )
    ::TabelaFonte     := Array(21)
    ::TabelaFonte[01] := {|| SetMode(28, 132)}
    ::TabelaFonte[02] := {|| SetMode(::AlturaFonteDefaultWindows, ::LarguraFonteDefaultWindows)}
    ::TabelaFonte[03] := {|| SetMode(25 , 80)}
    ::TabelaFonte[04] := {|| SetMode(28 , 80)}
    ::TabelaFonte[05] := {|| SetMode(33 , 80)}
    ::TabelaFonte[06] := {|| SetMode(40 , 80)}
    ::TabelaFonte[07] := {|| SetMode(43 , 80)}
    ::TabelaFonte[08] := {|| SetMode(50 , 80)}
    ::TabelaFonte[09] := {|| SetMode(25 , 132)}
    ::TabelaFonte[10] := {|| SetMode(28 , 132)}
    ::TabelaFonte[11] := {|| SetMode(33 , 132)}
    ::TabelaFonte[12] := {|| SetMode(40 , 132)}
    ::TabelaFonte[13] := {|| SetMode(43 , 132)}
    ::TabelaFonte[14] := {|| SetMode(50 , 132)}
    ::TabelaFonte[15] := {|| SetMode(25 , 160)}
    ::TabelaFonte[16] := {|| SetMode(28 , 160)}
    ::TabelaFonte[17] := {|| SetMode(33 , 160)}
    ::TabelaFonte[18] := {|| SetMode(40 , 160)}
    ::TabelaFonte[19] := {|| SetMode(43 , 160)}
    ::TabelaFonte[20] := {|| SetMode(50 , 160)}
    ::TabelaFonte[21] := {|| SetMode(::FonteManualAltura, ::FonteManualLargura)}
    ::SetSet()

    if ::fonte > 1
        eval( ::TabelaFonte[ ::Fonte ] )
    endif
    FT_Shadow( ::Sombra )
    return( Self )


static FUNCTION TAmbiente_SetSet( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LETO_SET( 27, "Off" )
    LETO_SET( 26, "On" )
    LETO_SET( 32, "Off" )
    LETO_SET( 35, "On" )
    LETO_SET( 36, 22 ) ; LETO_SET( 37, .F. )
    Leto_Set( 11, "on" )
    LETO_SET( 11, "on" )
    LETO_SET( 4, iif( __SetCentury(), "dd/mm/yyyy", "dd/mm/yy" ) )
    LETO_SET( 3, 2 )
    LETO_SET( 24, "" )
    LETO_SET( 2, "On" )
    SetCancel( .F. )
    return( self )


static FUNCTION TAmbiente_SetVar( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    if ::Visual <> NIL
        ::Frame  := "…–À« Ã»∂"
    else
        ::Frame  := "⁄ƒø≥Ÿƒ¿≥"
    endif
    ::Sombra              := .T.
    ::Mostrar_Desativados := .T.
    ::Mostrar_Recibo      := .T.
    ::PosiAgeInd          := .F.
    ::PosiAgeAll          := .F.
    ::Receposi            := .F.
    ::lReceber            := .F.
    ::cTipoRecibo         := "RECCAR"
    ::lGreenCard          := .F.
    ::lComCodigoAcesso    := .F.
    ::aFiscalIni          := NIL
    ::xLimite             := NIL
    ::_Empresa            := ""
    ::xNomefir            := ""
    ::xEmpresa            := ""
    ::xJuroMesSimples     := 0
    ::xJuroMesComposto    := 1
    ::xFanta              := ""
    ::aSciArray           := Array(1,8)
    ::aAtivo              := {}
    ::aAtivoSwap          := {}
    ::lContinuarAchoice   := .F.
    ::lK_Insert           := .F.
    ::lK_Insert_Plus      := .F.
    ::ZebrarAmostragem    := .F.
    ::lMostrarSoma        := .T.

    ::CorMsg        := 47
    ::CorAlerta     := 75
    ::Fonte         := 1
    ::CorBorda      := 16
    ::CorAntiga     := 05
    ::CorCima       := 128
    ::CorBox        := 9
    ::CorCabec      := 59
    ::CorFundo      := 31
    ::Selecionado   := 10
    ::Ano2000       := .F.
    ::xUsuario      := "ADMIN"

    return( self )


static FUNCTION TAmbiente_SetModeMenu( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente





















    ::ModeMenu     := { "Resetar Para Default Sistema",    "Tamanho Padrao da Janela do Windows", "25 x  80 - CGA EGA VGA Somente",    "28 x  80 - EGA VGA Somente",    "33 x  80 - EGA VGA Somente",    "40 x  80 - EGA VGA Somente",    "43 x  80 - EGA VGA Somente",    "50 x  80 - EGA VGA Somente",    "25 x 132 - EGA VGA Somente",    "28 x 132 - EGA VGA Somente",    "33 x 132 - EGA VGA Somente",    "40 x 132 - EGA VGA Somente",    "43 x 132 - EGA VGA Somente",    "50 x 132 - EGA VGA Somente",    "25 x 160 - EGA VGA Somente",    "28 x 160 - EGA VGA Somente",    "33 x 160 - EGA VGA Somente",    "40 x 160 - EGA VGA Somente",    "43 x 160 - EGA VGA Somente",    "50 x 160 - EGA VGA Somente",    "Definir Layout Modo Manualmente",    "Testar Layout pre-definidos"}
    return( self:modemenu )


static FUNCTION TAmbiente_SetPano( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente

































































































    ::Panos         :=     {"∞ƒ",    "*#*#*∞V±I≤L€M∞A±R≤:;*#*#*",    "∞E±V≤I€LπI",    "∞±≤≤±∞∞±≤≥±ƒ",    " Macrosoft ",     "€≤∞±Macrosoft€±≤∞",    "∞∞∞∞∞∞∞∞∞∞±±±±±±±±±≤≤≤≤≤≤≤≤≤≤±±±±±±±±±±",     "∞∞∞∞∞∞∞∞∞±±±±±±±±≤≤≤≤≤≤≤≤≤±±±±±±±±±",     "±±∞±≤±≤∞±∞±∞∞≤∞≤±≤±≤≤±±≤€≤±±≤∞≤≤",     "±±∞±≤±≤∞±∞±∞∞≤∞≤±≤±≤≤±±≤€≤",     "±±∞±≤±≤∞±∞±∞∞≤∞≤±≤±≤≤",     "∞≤±≤±≤∞±≤±∞≤∞±≤∞≤∞≤±",     "±±∞±≤±≤∞±∞±∞∞≤∞≤±≤±≤≤±±≤€≤∞",     "±±±±±±±∞∞∞∞∞∞∞∞",     "≤≤≤≤≤≤≤±±±±±±",     "≤≤≤≤≤≤≤±±±±±",     "∞±≤€≤±∞",    " ∞±≤€≤±∞",     "  ∞∞±±≤≤±±∞∞",     " ∞±≤€",     "∞±≤",     "€",     "≤",     "±",     "∞",     "≈≈",     " ",    "˛˛˛˛˛˛˛˛˛˛˛˛˛˛",    "ﬂ", "›", "?", "˜", "˛", "?", "?","?", "", "", "?", "?",    "", "", "?", "?", "", "?", "	", "?", "?", "",    "˙.˘,˙'˘.';˘˛˘˙    ",    "˙.˘.'˙.'˘.˘'",     "Macrosoft Informatica                                       ",     "Macrosoft Informatica                                      ",     "Macrosoft Informatica                                     ",     "Macrosoft Informatica                                    ",     "Macrosoft Informatica                                   ",     "Macrosoft Informatica                                  ",     "Macrosoft Informatica                                 ",     "Macrosoft                                            ",     "Macrosoft                                           ",     "Macrosoft                                          ",     "Macrosoft                                         ",     "Macrosoft                                        ",     "Macrosoft                                       ",     "Macrosoft                                      ",     "Macrosoft                                     ",     "Macrosoft                                    ",     "Macrosoft                                   ",     "Macrosoft                                  ",     "Macrosoft                                 ",     "Macrosoft                                ",     "Macrosoft                               ",     "Macrosoft                              ",     "Macrosoft                             ",     "Macrosoft                            ",     "Macrosoft                           ",     "Macrosoft                          ",     "Macrosoft                         ",     "Macrosoft                        ",     "Macrosoft                       ",     "Macrosoft                      ",     "Macrosoft                     ",     "Macrosoft                    ",     "Macrosoft                   ",     "Macrosoft                  ",     "Macrosoft                 ",     "Macrosoft                ",     "Macrosoft               ",     "Macrosoft              ",     "Macrosoft             ",     "Macrosoft            ",     "Macrosoft           ",     "Macrosoft          ",     "Macrosoft         ",     "Macrosoft        ",     "Macrosoft       ",     "Macrosoft      ",     "Macrosoft     ",     "Macrosoft    ",     "Macrosoft   ",     "Macrosoft  ",     "Macrosoft ",     "Macrosoft","ƒ¡¬", "∞±≤€", "≤", "±", "€", "∞", "Œ", " ¿ø", " …º", "ƒ¡¬", " ", "˙.˘.'˙.'˘.˘'",    "¿ø¿ø",    " ÀÀ ",    "¡¬¬¡",    "√¥¥√",    "πÃÃπ",    "∞∞∞∞∞±±±±±∞∞∞∞∞≤≤≤≤≤",    "Õ ÕÀÕÀÕ ",    "ƒ¡ƒ¬ƒ¬ƒ¡",    "=-",    ":-",    "%%",    "##",    "@@"}
    return( self:panos )


static FUNCTION TAmbiente_SetaFrame( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL cScreen := SaveScreen()
    LOCAL nChoice := 1











    LOCAL aFrames := {"        ",    ( Chr( 218 ) + Chr( 196 ) + Chr( 191 ) + Chr( 179 ) +  Chr( 217 ) + Chr( 196 ) + Chr( 192 ) + Chr( 179 ) ),    ( Chr( 201 ) + Chr( 205 ) + Chr( 187 ) + Chr( 186 ) +  Chr( 188 ) + Chr( 205 ) + Chr( 200 ) + Chr( 186 ) ),    ( Chr( 214 ) + Chr( 196 ) + Chr( 183 ) + Chr( 186 ) +  Chr( 189 ) + Chr( 196 ) + Chr( 211 ) + Chr( 186 ) ),    ( Chr( 213 ) + Chr( 205 ) + Chr( 184 ) + Chr( 179 ) +  Chr( 190 ) + Chr( 205 ) + Chr( 212 ) + Chr( 179 ) ),    hb_UTF8ToStrBox( "‚îå‚îÄ‚îê‚îÇ‚îò‚îÄ‚îî‚îÇ" ),    hb_UTF8ToStrBox( "‚ïî‚ïê‚ïó‚ïë‚ïù‚ïê‚ïö‚ïë" ),    hb_UTF8ToStrBox( "‚ïì‚îÄ‚ïñ‚ïë‚ïú‚îÄ‚ïô‚ïë" ),    hb_UTF8ToStrBox( "‚ïí‚ïê‚ïï‚îÇ‚ïõ‚ïê‚ïò‚îÇ" ),    "ﬂﬂﬂﬁ‹‹‹›",    "€€€€€€€€€",    "…–À« Ã»∂"}

    M_Title("ESCOLHA O TIPO DE BORDA/FRAME")
    nChoice := Fazmenu( 03, 10, aFrames, ::Cormenu )
    ResTela( cScreen )
    if nChoice = 0
        return
    endif
    ::Frame := aFrames[nChoice]
    M_Frame( ::Frame )
    return Self


static FUNCTION TAmbiente_xMenu( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL AtPrompt := {}
    AADD( AtPrompt, {"I^nclusao",  {"S^ubMenu A","SubMenu B^","","Item D^esativado","Sub^Menu D"}})
    AADD( AtPrompt, {"A^lteraro",  {"SubMenu 1","SubMenu 2","SubMenu 3","SubMenu 4"}})
    AADD( AtPrompt, {"I^mpressao", {"SubMenu 1","SubMenu 2","SubMenu 3","SubMenu 4"}})
    AADD( AtPrompt, {"C^onsulta",  {"SubMenu 1","SubMenu 2","SubMenu 3","SubMenu 4"}})
    AADD( AtPrompt, {"H^elp",      {"SubMenu 1","SubMenu 2","SubMenu 3","SubMenu 4"}})
    return( AtPrompt )


static FUNCTION TAmbiente_xDisp( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL aDisp := {}
    Aadd( aDisp, { .T., .T., .F., .F., .T., .T. , .T.})
    Aadd( aDisp, { .T., .T., .T., .T., .T., .T. , .T.})
    Aadd( aDisp, { .T., .T., .T., .T., .T., .T. , .T.})
    Aadd( aDisp, { .T., .T., .T., .T., .T., .T. , .T.})
    Aadd( aDisp, { .T., .T., .T., .T., .T., .T. , .T.})
    Aadd( aDisp, { .T., .T., .T., .T., .T., .T. , .T.})
    Aadd( aDisp, { .T., .T., .T., .T., .T., .T. , .T.})
    return( aDisp )


static FUNCTION TAmbiente_Limpa( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
   Cls( ::CorFundo, ::PanoFundo )
    ::StatSup()
    ::StatInf()
    return self


static FUNCTION TAmbiente_StatSup( cCabecalho ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nTam  := MaxCol()+1
    LOCAL nPos  := ( nTam - Len( ::StatusSup ))

    aPrint( 00 , 00 , "", nTam )
   aPrint( 00 , 00 , Padc( if( cCabecalho = NIL, ::StatusSup, cCabecalho), nTam ),  ::CorCabec, nTam )
    aPrint( 00 , ::MaxCol-18, Dtoc(Date()) + " " + (oAmbiente:Clock := Time()), omenu:corcabec)

    return Self


static FUNCTION TAmbiente_StatInf( cMensagem ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nTam  := MaxCol()+1
    LOCAL nCol  := MaxRow()
   LOCAL nPos  := ( nTam - Len(::Codifirma + ":" + ::xUsuario + "/" + ::NomeFirma ))

    aPrint( nCol, 00 , "", nTam )
   aPrint( nCol, 00 , if( cMensagem = NIL, ::StatusInf, cMensagem), ::CorCabec, nTam )
   aPrint( nCol, nPos,  ::Codifirma + ":" + ::xUsuario + "/" + ::NomeFirma, ::CorCabec )
    return self


static FUNCTION TAmbiente_statReg( cMensagem, nCor ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nTam  := ::MaxCol
    LOCAL nCol  := MaxRow()
    LOCAL nPos  := ( nTam - Len(::Codifirma + ":" + ::xUsuario + "/" + ::NomeFirma ))
    IF nCor == NIL ; nCor := ::CorCabec ; END


    Print( nCol, 00 , if( cMensagem = NIL, ::StatusInf, cMensagem), nCor, iif(nCor <> ::CorCabec, MaxCol()+1, nil))

    return Self


static FUNCTION TAmbiente_SetaSombra( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    FT_Shadow( ::Sombra )
    return Self


static FUNCTION TAmbiente_SetaCor( nTipo ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente










    LOCAL aTipo      := { ::CorMenu, ::CorCabec, ::CorFundo, ::CorDesativada, ::CorLightBar, ::CorHotKey, ::CorHKLightBar, ::CorAlerta, ::CorMsg, ::CorBorda,    }

    LOCAL    cPanoFundo     := ::PanoFundo
    LOCAL       cScreen    := SaveScreen()
    LOCAL         xTipo  := if( nTipo = NIL, 1, nTipo )
    LOCAL        xColor    := aTipo[ xTipo ]
    LOCAL        CorAnt    := aTipo[ xTipo ]
    LOCAL lManterScreen     := .F.
    LOCAL         oTemp     := TAmbienteNew()
    LOCAL     nLenAtipo  := Len( aTipo )
    LOCAL          ikey

    while( .T. )
        oTemp:CorMenu           := aTipo[01]
        oTemp:CorCabec          := aTipo[02]
        oTemp:CorFundo              := aTipo[03]
        oTemp:CorDesativada     := aTipo[04]
        oTemp:CorLightBar       := aTipo[05]
        oTemp:CorHotKey         := aTipo[06]
        oTemp:CorHKLightBar     := aTipo[07]
        oTemp:CorAlerta         := aTipo[08]
        oTemp:CorMsg            := aTipo[09]
        oTemp:CorBorda          := aTipo[10]

        oTemp:PanoFundo           := cPanoFundo
        oTemp:StatusSup           := "TESTE DE COR - TAYSON CabeáÑo"
        oTemp:StatusInf         := "TESTE DE COR - Rodape"

        __Keyboard( ( Chr(27)) )
        oTemp:Show(lManterScreen := .T.)
        M_Frame( ::Frame )
        ::HelpCor(xColor)
        ikey := inkey(0)

        switch iKey
        case 24
            aTipo[ xTipo ] := ( XColor  := Iif( xColor  == 0, 255, --xColor  ))
            exit
        case 5
            ( aTipo[ xTipo ] ) :=  ( xColor    := Iif( xColor  == 255, 0, ++xColor  ))
            exit
        case 18
            ( aTipo[ xTipo ] ) :=  ( xColor    := Iif( xColor  == 255, 0, xColor + 16  ))
            if(xColor >= 255 )
                   xColor := 255
                endif
            exit
        case 3
            ( aTipo[ xTipo ] ) :=  ( xColor    := Iif( xColor  == 255, 0, xColor - 16  ))
                if(xColor <= 0 )
                   xColor := 0
                endif
            exit
        case 30
            ( aTipo[ xTipo ] ) :=  ( xColor    := 0)
            exit
        case 29
            ( aTipo[ xTipo ] ) := ( xColor := CorAnt )
            exit
        case 31
            ( aTipo[ xTipo ] ) :=  ( xColor    := 255)
            exit
        case 13
           exit
        case 27
            resTela( cScreen )
            return self
        otherwise
           HB_KeyPut(lastkey())
            SetCursor(1) ; SetPos( 28, 78 ) ; AAdd( GetList, _GET_( xColor, "xColor", "999", {|| (xcolor >= 0 .AND. xColor <= 255)},))
            ReadModal( GetList, NIL,,,,, ) ; GetList := {} ; ( GetList )
            if lastkey() <> 27
                ( aTipo[ xTipo ] ) := xColor
            endif
            hb_keySetLast(0)
            exit
        endswitch
        if lastkey() == 13
           exit
        endif
        Do case
        Case nTipo = 1
            aTipo[ 4 ] := AscanCorDesativada(aTipo[1])
            aTipo[ 5 ] := Roloc(aTipo[1])
            aTipo[ 6 ] := AscanCorHotKey( aTipo[1])
            aTipo[ 7 ] := AscanCorHKLightBar( aTipo[5])
        Case nTIpo = 5
            aTipo[ 6 ] := AscanCorHotKey(aTipo[1])
            aTipo[ 7 ] := AscanCorHKLightBar( aTipo[5])
        EndCase
    enddo
    ::CorMenu           := aTipo[01]
    ::CorCabec          := aTipo[02]
    ::CorFundo            := aTipo[03]
    ::CorDesativada     := aTipo[04]
    ::CorLightBar       := aTipo[05]
    ::CorHotKey         := aTipo[06]
    ::CorHKLightBar     := aTipo[07]
    ::CorAlerta         := aTipo[08]
    ::CorMsg            := aTipo[09]
    ::CorBorda          := aTipo[10]

    return SeLF


static FUNCTION TAmbiente_HelpCor( xColor ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    linhaembranco   := ";"
    linhahorizontal := "-"










    AlertaPy(   "  COR ATUAL : " + StrZero( xColor, 3 )  + ";" +     linhahorizontal + ";;" +     "      ENTER : ACEITAR ESCOLHA           " + ";" +     "        ESC : CANCELAR                  " + ";" +     "  CTRL+HOME : VOLTA PARA COR ANTERIOR   " + ";" +     "  CTRL+PGDN : PRIMEIRA COR              " + ";" +     "  CTRL+PGUP : ULTIMA COR                " + ";" +  "       PGUP : PULAR 16 CORES PARA CIMA  " + ";" +  "       PGDN : PULAR 16 CORES PARA BAIXO " + ";" +  " SETA ACIMA : MUDA COR                  " + ";" +  " SETA ABAIXO: MUDA COR                  ", xColor, .T., .F.)
    return nil

static FUNCTION TAmbiente_SetaPano( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente

    LOCAL nPano
    LOCAL Selecionado  := 1
    LOCAL nKey             := 0
    LOCAL cScreen      := SaveScreen()
    LOCAL oTemp

    Aadd( ::Panos, TokenUpper(::xUsuario))
    nPano          := Len( ::Panos )
    nPos           := Ascan( ::Panos, ::Panofundo )
    Selecionado     := if( nPos = 0, 1, nPos )
    cPanoFundo        := ::PanoFundo
    cCormenu         := ::Cormenu
    cCorCabec      := ::CorCabec
    cCorFundo        := ::CorFundo

    oTemp           := TAmbienteNew()
    oTemp:PanoFundo := cPanoFundo
    oTemp:Cormenu     := cCormenu
    oTemp:CorCabec     := cCorCabec
    oTemp:CorFundo     := cCorFundo

    while( .T. )
        __Keyboard( ( Chr( 27 )) )
        oTemp:Show(lManterScreen := .F.)
        M_Frame( ::Frame )
        M_Message("Use as setas CIMA e BAIXO para trocar, ENTER para aceitar. Nß " + StrZero( Selecionado, 3 ), ::Cormenu )
        nKey := Inkey(0)
        if ( nKey == 27 .OR. nKey = 13 )
            Exit
        elseif nKey == 24
            Selecionado := Iif( Selecionado == 1, nPano, --Selecionado  )
        elseif nKey == 5
            Selecionado := Iif( Selecionado == nPano, 1, ++Selecionado  )
        endif
        oTemp:PanoFundo := ::Panos[ Selecionado ]
    EndDo
    ::PanoFundo := ::Panos[ Selecionado ]
    return Self


static FUNCTION TAmbiente_MaBox( nTopo, nEsq, nFundo, nDireita, Cabecalho, Rodape, lInverterCor ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
   LOCAL cPanoFundo := " "
   LOCAL nCor       := if( lInverterCor = NIL, ::Cormenu,  lInverterCor )
   LOCAL pback


   if nDireita = 79
       nDireita = ::MaxCol
   endif
   ColorSet( @nCor, @pback )
   MS_Box( nTopo, nEsq, nFundo, nDireita, ::Frame + cPanoFundo, nCor )
   if Cabecalho <> Nil
       aPrint( nTopo, nEsq+1, "€", Roloc( nCor ), (nDireita-nEsq)-1)
       aPrint( nTopo, nEsq+1, Padc( Cabecalho, ( nDireita-nEsq)-1), Roloc( nCor ))
   endif
   if Rodape <> Nil
       aPrint( nFundo, nEsq+1, "€", Roloc( nCor ), (nDireita-nEsq)-1)
       aPrint( nFundo, nEsq+1, Padc( Rodape, ( nDireita-nEsq)-1), Roloc( nCor ))
   endif
   cSetColor( SetColor())
   nSetColor( nCor, Roloc( nCor ))

    return


static FUNCTION TAmbiente_AumentaEspacoMenu( nSp ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nTam    := Len(::menu)
    LOCAL cSpMais := Space(if(nSp == nil, nSp := 1, nSp))
    LOCAL nX

    for nX := 1 To nTam
       ::menu[nX,1] := ltrim(rtrim(::menu[nX,1]))
       ::menu[nX,1] := cSpMais + ::menu[nX,1] + cSpMais
    next
    return( self )


static FUNCTION TAmbiente_Show( lManterScreen ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
   LOCAL MenuClone := aClone( ::menu )
    LOCAL nSpMais   := 0
   LOCAL nChoice

    ::Limpa()
    ::StatSup()
   ::StatInf()
    if( lManterScreen == nil , lManterScreen := .F. , lManterScreen)
   M_Frame( ::Frame )

    if nSpMais > 1
        ::AumentaEspacoMenu(nSpMais)
    endif
   nChoice := ::MsMenu( 1, lManterScreen )
    ::menu  := Aclone( MenuClone)
    ::StatSup()
   ::StatInf()
    return (nChoice )


static FUNCTION TAmbiente_MSMenu( nLinha, lManterScreen ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL cScreen     := SaveScreen()
    LOCAL nMaxCol   := ::MaxCol
    LOCAL xScreen
    LOCAL nSoma      := 0
    LOCAL nX          := 0
    LOCAL nDireita  := 0
    LOCAL nVal         := 1
    LOCAL nMaior     := 1
    LOCAL nRetorno  := 0.0
    LOCAL cmenu      := ""
    LOCAL cPrinc     := ""
    LOCAL nKey         := 0
    LOCAL nMax         := 0
    LOCAL nBaixo     := 0
    LOCAL nTam      := 0
    LOCAL nTamSt     := 0
    LOCAL nCorrente := 1
    LOCAL aNew         := {}
    LOCAL aSelecao  := {}
    LOCAL oP          := 0
    LOCAL cJanela
    LOCAL nScr1
    LOCAL nScr2
    LOCAL nScr3
    LOCAL nScr4

    nLinha := if( nLinha = NIL, 0, nLinha )
    WHILE .T.
        nSoma      := 0
        nX          := 0
        nDireita  := 0
        nVal         := 1
        nMaior     := 1
        nRetorno  := 0.0
        cmenu      := ""
        cPrinc     := ""
        nKey         := 0
        nMax         := 0
        oP          := 0
        nBaixo     := 0
        nTamSt     := 0
        nCorrente := 1
        aNew         := {}
        aSelecao  := {}
        nTam      := 0

        ::MSmenuCabecalho( nLinha, ::nPos )
        FOR nX := 2 To ::nPos
            nSoma += Len( ::menu[nX-1 , 1]) + 1
        Next
        nX := 0

        FOR nX := 1 To Len( ::menu[ ::nPos, 2])
            if Empty( ::menu[::nPos, 2 , nX ])
                Aadd( aNew, "")
                Aadd( aSelecao, .T. )
            else
                Aadd( aNew, "  " + ::menu[::nPos,2, nX ] + "  " )
                Aadd( aSelecao, ::Disp[::nPos, nX ])
            endif
            nTamSt := Len( ::menu[::nPos,2, nX ]) + 2
            if nTamSt > nVal
                nVal     := nTamSt
                nMaior := nX
            endif
        Next

        nDireita  := Len( ::menu[::nPos, 2 , nMaior])+5
        nBaixo    := Len( ::menu[::nPos, 2])
        nTam         := nDireita + nSoma
        nMax         := if( nTam > nMaxCol, nMaxCol, nTam )
        nSoma      := if( nTam > nMaxCol, (nSoma-( nTam-nMaxCol)) , nSoma )
        nSoma      := if( nSoma < 0, 0, nSoma )
        nScr1      := 01+nLinha
        nScr2      := 00
        nScr3      := MaxRow()-1
        nScr4      := ::MaxCol
        xScreen     := SaveScreen( nScr1, nScr2, nScr3, nScr4 )
        MS_Box( 01+nLinha, nSoma, 02+nBaixo+nLinha, nMax, ::Frame, ::CorMenu )
        oP           := ::MsProcessa( 02+nLinha, nSoma+1, 02+nBaixo+nLinha, nMax-1, aNew, aSelecao )
        if !lManterScreen
            RestScreen( nScr1, nScr2, nScr3, nScr4, xScreen )
        endif
        cPrinc   := Str( ::nPos, 2 )
        cMenu     := StrZero( oP, 2 )
        nMax     := Len( ::Menu )
        nKey        := LastKey()
        nRetorno := Val( cPrinc + "." + cmenu )

        DO Case
            Case nKey = 13 .OR. nKey = 32
                if aSelecao[oP]
                    return( nRetorno )
                else
                    Alerta("ERRO: Item Desativado")
                endif
            Case nKey = 27 .OR. nKey = -33
                return( 0 )
            Case nKey = 4
                ::nPos++
            Case nKey = 19
                ::nPos--
            Case nKey = 1 .OR. nKey = 31 .OR. nKey = 18
                ::nPos := 1
            Case nKey = 6 .OR. nKey = 30 .OR. nKey = 3
                ::nPos := nMax
            OtherWise
                Eval( SetKey( nKey ))
        EndCase
        ::nPos := if( ::nPos > nMax, 1,    ::nPos )
        ::nPos := if( ::nPos < 1,    nMax, ::nPos )
    EndDo
    return


static FUNCTION TAmbiente_MSMenuCabecalho( nLinha, nPos ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
   LOCAL nMax    := ::MaxCol
    LOCAL nSoma   := 0
    LOCAL nSoma1  := 0
   LOCAL nX       := 0
   LOCAL nTam    := Len(::menu)
    LOCAL aHotKey := Array(nTam)
    LOCAL aRow    := Array(nTam)
    LOCAL aCol    := Array(nTam)
    LOCAL cHotKey := Space(0)
    LOCAL nLen
    LOCAL cMenu
    LOCAL nConta
    LOCAL cStr
    LOCAL cNew

    aPrint( nLinha, 00, " ", ::Cormenu, nMax )
    FOR nX := 1 To nTam
        cMenu   := ::menu[nX,1]
         cHotKey := Space(0)
        nSoma1  := 0
        StrHotKey(@cMenu, @cHotKey, 1)
        if (nSoma1 := Len(cHotKey)) > 1
           cHotKey := Right(cHotKey,1)
        endif
        nSoma1--
        ::menu[nX,1]:= cMenu
        aHotKey[nX] := cHotKey
        nLen        := Len( ::menu[nX,1])
        aRow[nX]    := nLinha
        aCol[nX]    := nSoma    + nSoma1
        aPrint( nLinha,   nSoma,    cMenu,       if( nPos = nX, ::CorLightBar,   ::CorMenu ))
        aPrint( aRow[nX], aCol[nX], aHotKey[nX], if( nPos = nX, ::CorHKLightBar, ::CorHotKey ))
       nSoma    += nLen + 1
        nSoma1   += nLen + 1
   Next
    return self


Function StrHotKey(cMenu, cHotKey, nMenuOuSubMenu)
   LOCAL cChar   := "^"
    LOCAL cSwap   := Space(0)
    LOCAL nDel    := 0
    LOCAL nPos    := 3
    LOCAL nConta
    LOCAL cStr
    LOCAL cNew

    if( nMenuOuSubMenu == 1, nPos := 3, nPos := 4)
    nConta := GT_StrCount( cChar, cMenu )
    if nConta <= 0
       cMenu := Stuff( cMenu, nPos, nDel, cChar )
    endif
    nConta := GT_StrCount( cChar, cMenu )
    if nConta >0
       cHotKey := StrExtract(cMenu, cChar, 1 )
       cMenu   := StrSwap(cMenu, cChar, 1, cSwap)
   endif
    return


static FUNCTION TAmbiente_MSProcessa( nCima, nEsquerda, nBaixo, nDireita, aNew, aSelecionado ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL nX       := 1
    LOCAL nTam      := Len( aNew )
    LOCAL aHotKey := Array(nTam)
    LOCAL aRow    := Array(nTam)
    LOCAL aCol    := Array(nTam)
    LOCAL nRow      := nCima-1
    LOCAL nMax      := nTam
    LOCAL nTamSt  := ( nDireita - nEsquerda ) + 1
    LOCAL nKey      := 1
    LOCAL nConta  := 0
    LOCAL cSep
   LOCAL cMenu
    LOCAL cStr
    LOCAL cNew
    STATI nItem

    nItem := ::ativo
    if ::Visual <> NIL
        if ::Frame == ( Chr( 218 ) + Chr( 196 ) + Chr( 191 ) + Chr( 179 ) +  Chr( 217 ) + Chr( 196 ) + Chr( 192 ) + Chr( 179 ) )
            cSep := "√" + Repl( "ƒ", nTamSt ) + "¥"
        else
            cSep := SubStr(::Frame, 4, 1) + Repl( "ƒ", nTamSt ) + SubStr(::Frame, 8,1)
        endif
    else
        cSep := Chr(195) + Repl( "ƒ", nTamSt ) + Chr(180)
    endif
    SetCursor(0)
    FOR nX := 1 To nTam
       cMenu       := aNew[nX]
       cHotKey     := Space(0)
        StrHotKey(@cMenu, @cHotKey, 2)
        aNew[nX]    := cMenu
        nLen        := (nTamSt-Len(cMenu))
        nSoma1      := 0
        if (nSoma1  := Len(cHotKey)) > 1
           cHotKey  := Right(cHotKey,1)
        endif
        nSoma1--
        aHotKey[nX] := cHotKey
        aRow[nX]    := nRow+nX
        aCol[nX]    := nEsquerda + nSoma1

        if Empty( cMenu )
            aPrint( nRow+nX, nEsquerda-1, cSep, ::CorMenu, nTamSt )
            Loop
        endif

        if aSelecionado[ nX ]
            aPrint( nRow+nX, nEsquerda, cMenu + Space(nLen), ::Cormenu )
        else
            nConta++
            aPrint( nRow+nX, nEsquerda, cMenu + Space(nLen), ::CorDesativada )
        endif
    Next

    if nItem > nMax
        nItem = nMax
    endif

    WHILE .T.
       cMenu := aNew[nItem]
       nLen  := (nTamSt-Len(cMenu))

        if nConta <> nMax
            if aSelecionado[ nItem ] .AND. !Empty( cMenu)
                 aPrint( nRow+nItem, nEsquerda, Upper(cMenu)   + Space(nLen), ::CorLightBar )
            endif
            if aSelecionado[ nItem ] .AND. Empty(cMenu)
                aPrint( nRow+nItem, nEsquerda-1, cSep, ::CorMenu )
                if LastKey() = 5
                    nItem--
                else
                    nItem++
                endif
                nItem := if( nItem > nMax, 1,     nItem )
                nItem := if( nItem < 1,     nMax, nItem )
                Loop
            endif
            if !::alterando
                if !aSelecionado[ nItem ]
                    aPrint( nRow+nItem, nEsquerda, cMenu + Space(nLen), ::CorDesativada )
                    if LastKey() = 5
                        nItem--
                    else
                        nItem++
                    endif
                    nItem := if( nItem > nMax, 1,    nItem )
                    nItem := if( nItem < 1,    nMax, nItem )
                    Loop
                endif
            endif
        endif

        FOR nX := 1 To nTam
            aPrint( aRow[nX], aCol[nX], aHotKey[nX], if(nItem == nX, ::CorHKLightBar, ::CorHotKey ))
       Next

        ::nMenuH := ::nPos
        ::nMenuV := nItem
        ::MostraPosicaoMenuNoCabecalho()

        nKey := Inkey(0)
        if ::Alterando
            aPrint( nRow+nItem, nEsquerda, aNew[nItem] + Space(nLen), if( aSelecionado[nItem], ::CorMenu, ::Cordesativada-1 ))
        else
            aPrint( nRow+nItem, nEsquerda, aNew[nItem] + Space(nLen), if( aSelecionado[nItem], ::Cormenu, ::Cordesativada ))
        endif

        Do Case
        Case nKey = 27 .OR. nKey = -33
            return( 0 )

        Case nKey = 13 .OR. nKey = 32
            return( nItem )

        Case nKey = 1 .OR. nKey = 31 .OR. nKey = 18
           if nItem == 1
               nItem := nMax
            else
                nItem := 1
            endif

        Case nKey = 6 .OR. nKey = 30 .OR. nKey = 3
           if nItem == nMax
               nItem := 1
            else
               nItem := nMax
            endif

        Case nKey = 4
            return( 4 )

        Case nKey = 19
            return( 19 )

        Case nKey = 5
            nItem--

        Case nKey = 24
            nItem++

        Case ( bAction := SetKey( nKey )) <> NIL
            Eval( bAction, ProcName(), ProcLine(), ReadVar())

        EndCase
        nItem   := if( nItem > nMax, 1,    nItem )
        nItem   := if( nItem < 1,    nMax, nItem )
        ::Ativo := nItem
    EndDo
    return( NIL )


static FUNCTION TAmbiente_MostraPosicaoMenuNoCabecalho( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    MS_SetConsoleTitle("MENU# " + ltrim(rtrim(::nMenuH)) + "." + ltrim(rtrim(::nMenuV)))
    return self


static FUNCTION TAmbiente_ContaReg( cMensagem, nCor ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    if cMensagem <> NIL
        if valtype( cMensagem ) <> "N"
            ::StatReg(cMensagem, nCor)
        else
            ::StatReg("REGISTRO #" + StrZero( cMensagem, 6), nCor)
            oAmbiente:nRegistrosImpressos := cMensagem
        endif
    else
        ::StatReg("REGISTRO #" + StrZero( ++oAmbiente:nRegistrosImpressos, 6), nCor)
    endif
    return( .T. )


static FUNCTION TAmbiente_Refresh( nItem ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    ::menu := Eval({|nItem|::menuarray[nItem]}, nItem )


    return


static FUNCTION TAmbiente_EscapeCode( ) ; local Self AS CLASS TAmbiente := QSelf() AS CLASS TAmbiente
    LOCAL hESCP    := {=>}
    HSetCaseMatch( hESCP, .F. )


    hESCP["reset"            ] := "#27#64"
    hESCP["halfon"           ] := "#27#115#49"
    hESCP["halfoff"          ] := "#27#115#48"
    hESCP["unidirecionalonly"] := "#27#60"
    hESCP["unidirecionalon"  ] := "#27#85#49"
    hESCP["unidirecionalonff"] := "#27#85#48"
    hESCP["paperdisable"     ] := "#27#56"
    hESCP["paperenable"      ] := "#27#57"
    hESCP["beeper"           ] := "#7"


    hESCP["CR"               ] := "#13"
    hESCP["CAN"              ] := "#24"
    hESCP["DEL"              ] := "#127"


    hESCP["LF"               ] := "#10"
    hESCP["FF"               ] := "#12"
    hESCP["PageLenghtInLines"] := "#27#67#66"
    hESCP["PageLenghtInInche"] := "#27#67#48#11"
    hESCP["SaltoPicoteLig"   ] := "#27#78#66"
    hESCP["SaltoPicoteDes"   ] := "#27#79"
    hESCP["_Spaco1_8"        ] := "#27#48"
    hESCP["_Spaco7_72"       ] := "#27#49"
    hESCP["_Spaco1_6"        ] := "#27#50"
    hESCP["_SpacoN_216"      ] := "#27#51#66"
    hESCP["_SpacoN_72"       ] := "#27#51#66"
    hESCP["ESCJn"            ] := "#27#51#66"
    hESCP["VT"               ] := "#11"


    hESCP["draft"            ] := "#27#120#48"
    hESCP["nlq"              ] := "#27#120#49"
    hESCP["nlqroman"         ] := "#27#107#48"
    hESCP["nlqserif"         ] := "#27#107#49"


    hESCP["EmphasizedOn"     ] := "#27#69"
    hESCP["EmphasizedOff"    ] := "#27#70"
    hESCP["DoubleStrikeOn"   ] := "#27#71"
    hESCP["DoubleStrikeOff"  ] := "#27#72"
    hESCP["SuperScriptOn"    ] := "#27#83"
    hESCP["SuperScriptOff"   ] := "#27#84"
    hESCP["ItalictOn"        ] := "#27#52"
    hESCP["ItalictOff"       ] := "#27#53"
    hESCP["UnderlineOn"      ] := "#27#45#49"
    hESCP["UnderlineOff"     ] := "#27#45#48"


    hESCP["nlqleft"          ] := "#27#97#48"
    hESCP["nlqcenter"        ] := "#27#97#49"
    hESCP["nlqright"         ] := "#27#97#50"
    hESCP["nlqfull"          ] := "#27#97#51"
    return hESCP


function TAmbienteNew()
    return( TAmbiente():New())

